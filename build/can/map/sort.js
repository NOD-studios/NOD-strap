define(["can/util/library","can/list"],function(t){var r=t.List._bubbleRule;if(t.List._bubbleRule=function(t,e){return e.comparator?"change":r.apply(this,arguments)},t.Model){var e=t.Model.List._bubbleRule;t.Model.List._bubbleRule=function(t,r){return r.comparator?"change":e.apply(this,arguments)}}var i=t.List.prototype,n=i._changes,a=i.setup;t.extend(i,{comparator:void 0,sortIndexes:[],sortedIndex:function(t){for(var r=t.attr(this.comparator),e=0,i=0,n=this.length;n>i;i++)if(t!==this[i]){if(r<=this[i].attr(this.comparator))return i+e}else e=-1;return i+e},sort:function(r,e){var i=this.comparator,n=i?[function(t,r){return t="function"==typeof t[i]?t[i]():t[i],r="function"==typeof r[i]?r[i]():r[i],t===r?0:r>t?-1:1}]:[r];return e||t.trigger(this,"reset"),Array.prototype.sort.apply(this,n)}});var s=function(r){return r[0]&&t.isArray(r[0])?r[0]:t.makeArray(r)};return t.each({push:"length",unshift:0},function(r,e){var i=t.List.prototype,n=i[e];i[e]=function(){var e=s(arguments),i=r?this.length:0,a=n.apply(this,arguments);return this.comparator&&e.length&&(this.sort(null,!0),t.batch.trigger(this,"reset",[e]),this._triggerChange(""+i,"add",e,void 0)),a}}),i._changes=function(r,e,i,a,s){if(this.comparator&&/^\d+./.test(e)){var o=+/^\d+/.exec(e)[0],u=this[o];if("undefined"!=typeof u){var h=this.sortedIndex(u);if(h!==o)return[].splice.call(this,o,1),[].splice.call(this,h,0,u),t.trigger(this,"move",[u,h,o]),void t.trigger(this,"change",[e.replace(/^\d+/,h),i,a,s])}}n.apply(this,arguments)},i.setup=function(){a.apply(this,arguments),this.comparator&&this.sort()},t.Map});
//# sourceMappingURL=sort.js.map