define(["can/util/library","can/view/target","can/view/stache/utils","can/view/stache/mustache_core"],function(t,e,i,n){var a=function(){var t=document.createElement("div");return function(e){return-1===e.indexOf("&")?e.replace(/\r\n/g,"\n"):(t.innerHTML=e,0===t.childNodes.length?"":t.childNodes[0].nodeValue)}}(),r=function(){this.stack=[new s]};t.extend(r.prototype,i.mixins),t.extend(r.prototype,{startSubSection:function(t){var e=new s(t);return this.stack.push(e),e},endSubSectionAndReturnRenderer:function(){if(this.last().isEmpty())return this.stack.pop(),null;var e=this.endSection();return t.proxy(e.compiled.hydrate,e.compiled)},startSection:function(t){var e=new s(t);this.last().add(e.targetCallback),this.stack.push(e)},endSection:function(){return this.last().compile(),this.stack.pop()},inverse:function(){this.last().inverse()},compile:function(){var e=this.stack.pop().compile();return function(i,a){return i instanceof t.view.Scope||(i=new t.view.Scope(i||{})),a instanceof n.Options||(a=new n.Options(a||{})),e.hydrate(i,a)}},push:function(t){this.last().push(t)},pop:function(){return this.last().pop()}});var s=function(e){this.data="targetData",this.targetData=[],this.targetStack=[];var i=this;this.targetCallback=function(n,a,r){e.call(this,n,a,r,t.proxy(i.compiled.hydrate,i.compiled),i.inverseCompiled&&t.proxy(i.inverseCompiled.hydrate,i.inverseCompiled))}};return t.extend(s.prototype,{inverse:function(){this.inverseData=[],this.data="inverseData"},push:function(t){this.add(t),this.targetStack.push(t)},pop:function(){return this.targetStack.pop()},add:function(t){"string"==typeof t&&(t=a(t)),this.targetStack.length?this.targetStack[this.targetStack.length-1].children.push(t):this[this.data].push(t)},compile:function(){return this.compiled=e(this.targetData),this.inverseData&&(this.inverseCompiled=e(this.inverseData),delete this.inverseData),delete this.targetData,delete this.targetStack,this.compiled},children:function(){return this.targetStack.length?this.targetStack[this.targetStack.length-1].children:this[this.data]},isEmpty:function(){return!this.targetData.length}}),r});
//# sourceMappingURL=html_section.js.map